OCaml polymorphic map. Code taken from ExtLib, with minor additions.
